<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>å°ç£ä¾¿åˆ©å•†åº—å„€è¡¨æ¿</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸª</text></svg>">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>

  <!-- MongoDB Charts Embedding SDK -->
  <script src="https://unpkg.com/@mongodb-js/charts-embed-dom"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body{
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      min-height: 100vh;
      color: #2c3e50;
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }

    /* Navbar */
    .navbar{
      position: fixed; top: 0; left: 0; right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.10);
      z-index: 999;
      transition: all .25s ease;
    }
    .cc{
      margin: -0.1% 2.2%;
      margin-top: 10;
      background-position: center 5px;
      box-shadow: 0px 4px 10px -2px rgb(0,0,0,0.5);
      transform: 0.4s ease-out;
      border-radius: 15px;
      background-color: rgba(255, 255, 255, 0.1);
    }
    .navbar.scrolled{ box-shadow: 0 6px 18px rgba(0,0,0,0.14); }

    .navbar-content{
      max-width: 1400px;
      margin: 0 auto;
      padding: 14px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      position: relative; /* è®“æ‰‹æ©Ÿç‰ˆä¸‹æ‹‰é¸å–®å®šä½ç”¨ */
    }
    .navbar-brand{
      display:flex; align-items:center; gap:8px;
      font-weight: 800;
      color: #667eea;
      font-size: 15px;
      white-space: nowrap;
    }

    /* âœ… æŠ˜ç–ŠæŒ‰éˆ•ï¼ˆæ¼¢å ¡ï¼‰ */
    .nav-toggle{
      display: none;
      width: 42px;
      height: 42px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.92);
      cursor: pointer;
      font-size: 20px;
      font-weight: 900;
      color:#334155;
      box-shadow: 0 6px 16px rgba(0,0,0,.10);
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .nav-toggle:hover{ transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,.12); }
    .nav-toggle:active{ transform: scale(.98); }

    .nav-links{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap: wrap;
      justify-content:flex-end;
    }
    .nav-link{
      color:#4a5568;
      text-decoration:none;
      font-size: 13px;
      font-weight: 600;
      padding: 8px 10px;
      border-radius: 10px;
      transition: all .2s ease;
      cursor:pointer;
      user-select:none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .nav-link:hover{ background:#f0f4ff; color:#667eea; }

    .theme-toggle{
      background: rgba(255,255,255,0.95);
      border: none;
      width: 40px; height: 40px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,.12);
      transition: all .2s ease;
      font-size: 18px;
      display:flex; align-items:center; justify-content:center;
      flex: 0 0 auto;
    }
    .theme-toggle:hover{ transform: scale(1.06); }

    /* Header */
    header{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
      padding: 120px 0 56px;
      margin-bottom: 26px;
      position: relative;
      overflow: hidden;
    }
    header::before{
      content:'';
      position:absolute; inset:0;
      background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="2" fill="white" opacity="0.1"/></svg>');
      animation: float 18s linear infinite;
    }
    @keyframes float { 0%{transform:translateY(0)} 100%{transform:translateY(-100px)} }

    .header-content{ text-align:center; position:relative; z-index:1; }
    h1{
      font-size: 34px;
      font-weight: 800;
      color:#fff;
      margin-bottom: 10px;
      letter-spacing:-0.5px;
      text-shadow: 0 2px 10px rgba(0,0,0,0.18);
    }
    .subtitle{ font-size: 16px; color: rgba(255,255,255,.95); }
    .badge{
      display:inline-block;
      background: rgba(255,255,255,0.22);
      border: 1px solid rgba(255,255,255,0.28);
      color:#fff;
      padding: 8px 16px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 700;
      margin-top: 14px;
      backdrop-filter: blur(10px);
    }

    /* Section title */
    .section{ margin: 22px 0 34px; }
    .section-header{ margin: 0 0 12px; }
    .section-header h2{
      font-size: 18px; font-weight: 800;
      color:#1a202c;
      display:flex; align-items:center; gap:8px;
    }
    .section-header p{ margin-top: 6px; font-size: 13px; color:#718096; line-height: 1.55; }

    /* Cards */
    .card{
      background:#fff;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      padding: 22px;
      transition: box-shadow .25s ease, transform .25s ease;
    }
    .card:hover{ box-shadow: 0 10px 30px rgba(0,0,0,0.12); transform: translateY(-2px); }

    /* Stats Cards */
    .stats-container{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 18px;
    }
    .stat-card{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      padding: 22px;
      color:#fff;
      box-shadow: 0 4px 15px rgba(102,126,234,0.25);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: transform .25s ease;
    }
    .stat-card:hover{ transform: translateY(-5px); }
    .stat-card:nth-child(2){ background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .stat-card:nth-child(3){ background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .stat-card:nth-child(4){ background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .stat-icon{ font-size: 30px; margin-bottom: 8px; }
    .stat-value{ font-size: 30px; font-weight: 900; margin-bottom: 4px; }
    .stat-label{ font-size: 13px; opacity: .92; font-weight: 600; }

    /* Brands */
    .brands-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 14px;
      max-width: 900px;
      margin: 0 auto;
    }
    .brand-card{
      background:#fff;
      border-radius: 14px;
      padding: 18px;
      text-align:center;
      border: 2px solid #e9ecef;
      cursor: pointer;
      position: relative;
      transition: all .25s ease;
    }
    .brand-card:hover{ transform: translateY(-8px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
    .brand-card.active{background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);; }
    .brand-card.active.seven { border-color: #009739; }
    .brand-card.active.family { border-color: #0072BC; }
    .brand-card.active.hilife { border-color: #E60012; }
    .brand-card.active.ok { border-color: #F05A28; }
    .brand-card.active.pxmart { border-color: #532B88; }

    .seven .brand-count { background: linear-gradient(135deg, #009739 0%, #007a2d 100%); }
    .family .brand-count { background: linear-gradient(135deg, #0072BC 0%, #005a96 100%); }
    .hilife .brand-count { background: linear-gradient(135deg, #E60012 0%, #b8000e 100%); }
    .ok .brand-count { background: linear-gradient(135deg, #F05A28 0%, #d14820 100%); }
    .pxmart .brand-count { background: linear-gradient(135deg, #532B88 0%, #3f2066 100%); }

    .brand-logo{
      width:100%; height: 78px;
      border-radius: 10px;
      background:#f8f9fa;
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
      margin-bottom: 10px;
    }
    .seven .brand-store-info { background: linear-gradient(135deg, #009739 0%, #007a2d 100%); }
    .family .brand-store-info { background: linear-gradient(135deg, #0072BC 0%, #005a96 100%); }
    .hilife .brand-store-info { background: linear-gradient(135deg, #E60012 0%, #b8000e 100%); }
    .ok .brand-store-info { background: linear-gradient(135deg, #F05A28 0%, #d14820 100%); }
    .pxmart .brand-store-info { background: linear-gradient(135deg, #532B88 0%, #3f2066 100%); }

    .brand-logo img{ width:100%; height:100%; object-fit:contain; padding:8px; transition: transform .25s ease; }
    .brand-card:hover .brand-logo img{ transform: scale(1.08); }

    .brand-name{ font-size: 13px; font-weight: 800; color:#4a5568; }
    .brand-count{
      position:absolute; top: 10px; right: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#fff;
      font-size: 11px;
      font-weight: 900;
      padding: 4px 10px;
      border-radius: 999px;
      opacity: 0;
      transform: scale(.85);
      transition: all .2s ease;
      box-shadow: 0 2px 8px rgba(102,126,234,.28);
    }
    .brand-store-info{
      margin-top: 12px;
      padding: 12px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 10px;
      color:#fff;
      opacity: 0;
      max-height: 0;
      overflow:hidden;
      transition: all .35s ease;
    }
    .brand-card.active .brand-count{ opacity:1; transform: scale(1); }
    .brand-card.active .brand-store-info{ opacity:1; max-height: 110px; }

    .store-number{ font-size: 30px; font-weight: 950; line-height: 1; margin-bottom: 4px; }
    .store-label{ font-size: 12px; opacity:.92; font-weight: 700; }

    /* Metrics (ä¿ç•™ä½ åŸæœ¬çš„æ¨£å¼) */
    .metrics-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 14px;
    }
    .metric-item{
      background:#f7fafc;
      border-radius: 14px;
      padding: 16px;
      border-left: 4px solid #667eea;
      transition: all .25s ease;
      cursor: pointer;
    }
    .metric-item:hover{ background:#edf2f7; transform: translateX(3px); box-shadow: 0 2px 8px rgba(0,0,0,0.10); }
    .metric-name{ font-weight: 900; color:#2d3748; margin-bottom: 6px; font-size: 14px; display:flex; gap: 8px; align-items:center;}
    .metric-description{ font-size: 13px; color:#718096; line-height: 1.55; }

    /* Dashboard mount + loading overlay */
    .dashboard-shell{ position: relative; }
    #dashboardMount{
      width: 100%;
      height: calc(100vh - 520px);
      min-height: 900px;
      border-radius: 10px;
      overflow: hidden;
    }
    .loading-overlay{
      position:absolute;
      inset: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 12px;
      background: rgba(255,255,255,0.86);
      backdrop-filter: blur(6px);
      border-radius: 10px;
    }
    .spinner{
      border: 3px solid #e2e8f0;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

    /* Scroll to top */
    .scroll-to-top{
      position: fixed;
      bottom: 90px;
      right: 22px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#fff;
      width: 56px; height: 56px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      font-size: 20px;
      box-shadow: 0 6px 18px rgba(102,126,234,0.36);
      opacity: 0;
      transform: scale(.85);
      transition: all .2s ease;
      z-index: 998;
    }
    .scroll-to-top.visible{ opacity:1; transform: scale(1); }
    .scroll-to-top:hover{ transform: scale(1.06); }

    /* Footer */
    footer{
      text-align:center;
      padding: 28px 20px 40px;
      color:#718096;
      font-size: 13px;
    }
    .tech-stack{ display:flex; justify-content:center; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    .tech-item{
      background: rgba(255,255,255,0.7);
      padding: 8px 14px;
      border-radius: 10px;
      font-size: 12px;
      color:#4a5568;
      font-weight: 800;
      transition: all .2s ease;
    }
    .tech-item:hover{ background:#667eea; color:#fff; transform: translateY(-2px); }

    /* Dark mode */
    body.dark-mode{ background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color:#e2e8f0; }
    body.dark-mode .navbar{ background: rgba(30,41,59,0.95); }
    body.dark-mode .nav-link{ color:#cbd5e1; }
    body.dark-mode .nav-link:hover{ background:#334155; color:#a5b4fc; }
    body.dark-mode .navbar-brand{ color:#a5b4fc; }
    body.dark-mode .card{ background:#1e293b; box-shadow: 0 4px 20px rgba(0,0,0,0.32); }
    body.dark-mode .metric-item{ background:#0f172a; }
    body.dark-mode .metric-item:hover{ background:#1e293b; }
    body.dark-mode .metric-name{ color:#f1f5f9; }
    body.dark-mode .metric-description{ color:#94a3b8; }
    body.dark-mode .brand-card{ background:#1e293b; border-color:#334155; }
    body.dark-mode .brand-card.active{ background: linear-gradient(135deg, #1e293b 0%, #334155 100%); }
    body.dark-mode .brand-logo{ background:#0f172a; }
    body.dark-mode .brand-name{ color:#cbd5e1; }
    body.dark-mode .loading-overlay{ background: rgba(15,23,42,0.72); color:#e2e8f0; }
    body.dark-mode .tech-item{ background: rgba(30,41,59,0.7); color:#cbd5e1; }
    body.dark-mode .nav-toggle{
      background: rgba(30,41,59,.95);
      border-color: rgba(255,255,255,.10);
      color:#e2e8f0;
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
    }

    /* Responsive */
    @media (max-width: 900px){
      .nav-links{ gap: 6px; }
      h1{ font-size: 26px; }
      header{ padding: 105px 0 48px; }
      #dashboardMount{ min-height: 520px; height: calc(100vh - 590px); }
    }

    /* âœ… æ‰‹æ©ŸæŠ˜ç–Š */
    @media (max-width: 768px){
      .nav-toggle{ display: inline-flex; align-items:center; justify-content:center; }

      .nav-links{
        position: absolute;
        top: calc(100% + 10px);
        right: 20px;
        left: 20px;
        background: rgba(255,255,255,.96);
        border: 1px solid rgba(0,0,0,.06);
        border-radius: 16px;
        box-shadow: 0 18px 40px rgba(0,0,0,.12);
        padding: 10px;
        display: grid;
        grid-template-columns: 1fr;
        gap: 6px;
        overflow: hidden;
        max-height: 0;
        opacity: 0;
        pointer-events: none;
        transform: translateY(-6px);
        transition: max-height .25s ease, opacity .18s ease, transform .18s ease;
      }

      .nav-links.show{
        max-height: 380px;
        opacity: 1;
        pointer-events: auto;
        transform: translateY(0);
      }

      .nav-link{
        width: 100%;
        justify-content: space-between;
        background: rgba(102,126,234,.08);
      }
      body.dark-mode .nav-links{
        background: rgba(30,41,59,.96);
        border-color: rgba(255,255,255,.08);
      }
      body.dark-mode .nav-link{
        background: rgba(165,180,252,.10);
      }

      .theme-toggle{
        width: 100%;
        border-radius: 14px;
        justify-content: center;
      }
    }

    @media (max-width: 520px){
      header{ padding: 95px 0 44px; }
      .stats-container{ grid-template-columns: 1fr; }
      #dashboardMount{ min-height: 420px; height: calc(100vh - 650px); }
    }

    /* âœ… Chatbot styles */
    .bot-launcher{
      position: fixed;
      right: 22px;
      bottom: 22px;
      width: 58px;
      height: 58px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 22px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      box-shadow: 0 14px 30px rgba(102,126,234,.35);
      z-index: 1200;
      user-select: none;
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    .bot-launcher:hover{
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 18px 40px rgba(102,126,234,.45);
      filter: brightness(1.03);
    }
    .bot-launcher:active{ transform: translateY(0) scale(.99); }

    .bot-badge{
      position:absolute;
      top: -8px;
      right: -8px;
      background: #ef4444;
      color: #fff;
      font-size: 11px;
      font-weight: 900;
      padding: 4px 8px;
      border-radius: 999px;
      border: 2px solid rgba(255,255,255,.95);
      box-shadow: 0 6px 14px rgba(239,68,68,.25);
    }

    .bot-panel{
      position: fixed;
      right: 22px;
      bottom: 94px;
      width: 370px;
      max-width: calc(100vw - 44px);
      height: 540px;
      max-height: calc(100vh - 150px);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      box-shadow: 0 22px 60px rgba(0,0,0,.18);
      overflow: hidden;
      display: none;
      z-index: 1200;
      border: 1px solid rgba(0,0,0,.06);
      backdrop-filter: blur(14px);
      transform-origin: bottom right;
      animation: botPop .16s ease;
    }
    @keyframes botPop{
      from{ transform: translateY(10px) scale(.98); opacity: .0; }
      to{ transform: translateY(0) scale(1); opacity: 1; }
    }
    body.dark-mode .bot-panel{
      background: rgba(15,23,42,.92);
      border-color: rgba(255,255,255,.08);
      box-shadow: 0 22px 60px rgba(0,0,0,.40);
    }

    .bot-header{
      padding: 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom: 1px solid rgba(0,0,0,.06);
      background: linear-gradient(135deg, rgba(102,126,234,.12), rgba(118,75,162,.10));
    }
    body.dark-mode .bot-header{
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(135deg, rgba(165,180,252,.12), rgba(196,181,253,.08));
    }

    .bot-title{ display:flex; gap: 10px; align-items:center; }
    .bot-avatar{
      width: 40px; height: 40px;
      border-radius: 14px;
      display:flex; align-items:center; justify-content:center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#fff;
      font-size: 20px;
      box-shadow: 0 10px 18px rgba(102,126,234,.28);
      overflow: hidden;
    }
    .bot-avatar img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display:block;
    }

    .bot-name{
      font-weight: 950;
      font-size: 14px;
      color:#0f172a;
      letter-spacing: .2px;
    }
    .bot-sub{
      font-size: 12px;
      color:#64748b;
      margin-top: 2px;
    }
    body.dark-mode .bot-name{ color:#f8fafc; }
    body.dark-mode .bot-sub{ color:#94a3b8; }

    .bot-close{
      border: none;
      width: 36px; height: 36px;
      border-radius: 12px;
      cursor: pointer;
      background: rgba(0,0,0,.05);
      color:#0f172a;
      transition: transform .15s ease, background .15s ease;
    }
    .bot-close:hover{ transform: scale(1.05); background: rgba(0,0,0,.08); }
    body.dark-mode .bot-close{
      background: rgba(255,255,255,.08);
      color:#e2e8f0;
    }
    body.dark-mode .bot-close:hover{ background: rgba(255,255,255,.12); }

    .bot-quick{
      padding: 10px 12px 12px;
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      border-bottom: 1px solid rgba(0,0,0,.06);
      background: rgba(255,255,255,.55);
    }
    body.dark-mode .bot-quick{
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(2,6,23,.25);
    }

    .bot-chip{
      border: 1px solid rgba(102,126,234,.22);
      background: rgba(102,126,234,.08);
      color:#334155;
      font-weight: 800;
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      cursor:pointer;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .bot-chip:hover{
      transform: translateY(-1px);
      border-color: rgba(102,126,234,.35);
      background: rgba(102,126,234,.12);
    }
    .bot-chip:active{ transform: translateY(0) scale(.99); }

    body.dark-mode .bot-chip{
      color:#e5e7eb;
      background: rgba(165,180,252,.10);
      border-color: rgba(165,180,252,.22);
    }
    body.dark-mode .bot-chip:hover{
      background: rgba(165,180,252,.14);
      border-color: rgba(165,180,252,.30);
    }

    .bot-messages{
      height: calc(90% - 56px - 64px - 58px);
      padding: 14px 12px;
      overflow: auto;
      scroll-behavior: smooth;
    }

    .bot-row{ display:flex; margin: 10px 0; gap: 8px; }
    .bot-row.user{ justify-content:flex-end; }
    .bot-row.bot{ justify-content:flex-start; }

    .bot-bubble{
      max-width: 82%;
      padding: 10px 12px;
      border-radius: 16px;
      font-size: 13px;
      line-height: 1.55;
      white-space: pre-wrap;
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
      border: 1px solid rgba(0,0,0,.06);
    }

    .bot-row.user .bot-bubble{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#fff;
      border: none;
      border-bottom-right-radius: 8px;
      box-shadow: 0 14px 28px rgba(102,126,234,.22);
    }

    .bot-row.bot .bot-bubble{
      background: rgba(15,23,42,.04);
      color:#0f172a;
      border-bottom-left-radius: 8px;
    }

    body.dark-mode .bot-row.bot .bot-bubble{
      background: rgba(255,255,255,.08);
      color:#e2e8f0;
      border-color: rgba(255,255,255,.10);
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
    }

    .bot-input{
      padding: 10px;
      display:flex;
      gap: 8px;
      border-top: 1px solid rgba(0,0,0,.06);
      background: rgba(255,255,255,.65);
    }
    body.dark-mode .bot-input{
      border-top: 1px solid rgba(255,255,255,.08);
      background: rgba(2,6,23,.25);
    }

    #botText{
      flex:1;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      padding: 11px 12px;
      font-size: 13px;
      outline: none;
      background: rgba(255,255,255,.92);
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    #botText:focus{
      border-color: rgba(102,126,234,.55);
      box-shadow: 0 0 0 4px rgba(102,126,234,.16);
    }
    body.dark-mode #botText{
      background: rgba(15,23,42,.55);
      border-color: rgba(255,255,255,.12);
      color:#e2e8f0;
    }
    body.dark-mode #botText:focus{
      box-shadow: 0 0 0 4px rgba(165,180,252,.18);
      border-color: rgba(165,180,252,.40);
    }

    .bot-input button{
      border: none;
      border-radius: 14px;
      padding: 11px 14px;
      font-weight: 950;
      cursor:pointer;
      color:#fff;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      box-shadow: 0 12px 24px rgba(102,126,234,.22);
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }
    .bot-input button:hover{
      transform: translateY(-1px);
      box-shadow: 0 16px 30px rgba(102,126,234,.30);
      filter: brightness(1.02);
    }
    .bot-input button:active{ transform: translateY(0) scale(.99); }

    @media (max-width: 520px){
      .bot-panel{
        right: 14px;
        bottom: 88px;
        width: calc(100vw - 28px);
        height: 560px;
      }
      .bot-launcher{
        right: 16px;
        bottom: 16px;
        width: 56px;
        height: 56px;
        border-radius: 18px;
      }
    }

    .team{ width: 500ps; margin-top: 20px; }
    .badge:hover{
      transform: scale(1.1);
      box-shadow: 0 19px 35px rgba(102,126,234,.80);
      filter: brightness(1.02);
    }
    .tech-stack{ margin-top: 18px; }

    /* =========================================================
       âœ… KPI Carouselï¼ˆæ”¹æˆï¼šä¸€æ’å¤šå¡ + å·¦å³åˆ‡æ› + dotsï¼‰
       ========================================================= */
    .kpi-carousel.multi{
      position: relative;
      display: grid;
      grid-template-columns: 56px 1fr 56px;
      align-items: center;
      gap: 10px;
      --perView: 4; /* âœ… æ¡Œæ©Ÿä¸€æ¬¡é¡¯ç¤º 5 å¼µï¼ˆåƒä½ æˆªåœ–ï¼‰ */ 
    }

    .kpi-carousel.multi .kpi-viewport{
      overflow: hidden;
      border-radius: 16px;
    }

    .kpi-carousel.multi .kpi-track{
      display: flex;
      gap: 20px;
      transition: transform .35s ease;
      will-change: transform;
      padding: 6px 2px;
    }

    .kpi-carousel.multi .kpi-card{
      flex: 0 0 calc((100% - (14px * (var(--perView) - 1))) / var(--perView));
    }

    .kpi-arrow{
      width: 56px;
      height: 56px;
      border-radius: 16px;
      border: 1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.92);
      cursor: pointer;
      font-size: 28px;
      font-weight: 900;
      color:#334155;
      box-shadow: 0 10px 22px rgba(0,0,0,.10);
      transition: transform .15s ease, box-shadow .15s ease, opacity .15s ease;
      user-select: none;
    }
    .kpi-arrow:hover{ transform: translateY(-1px); box-shadow: 0 14px 28px rgba(0,0,0,.14); }
    .kpi-arrow:active{ transform: scale(.98); }
    .kpi-arrow:disabled{ opacity: .35; cursor: not-allowed; }

    .kpi-dots{
      grid-column: 1 / -1;
      display:flex;
      justify-content:center;
      gap: 10px;
      margin-top: 12px;
    }
    .kpi-dot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: rgba(100,116,139,.25);
      transition: width .15s ease, background .15s ease;
    }
    .kpi-dot.active{
      width: 26px;
      background: rgba(102,126,234,.85);
    }

    /* è®“ KPI å¡ç‰‡æ›´åƒä½ æˆªåœ–é‚£ç¨®ã€Œå¡ç‰‡å¡Šã€ */
    .kpi-carousel.multi .metric-item{
      height: 100%;
      background: #f7fafc;
      border-radius: 16px;
      padding: 18px;
      border-left: 8px solid #667eea;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
      width: 280px;
      cursor: default;
    }
    .kpi-carousel.multi .metric-item:hover{
      transform: scale(1.05);
      background: rgba(255,255,255,0.1);
      box-shadow: 0 10px 24px rgba(0,0,0,0.1);
      

    }

    /* å¹³æ¿ï¼š3 å¼µ */
    @media (max-width: 1024px){
      .kpi-carousel.multi{
        --perView: 2;
        grid-template-columns: 52px 1fr 52px;
      }
      .kpi-arrow{ width: 52px; height: 52px; }
    }

    /* æ‰‹æ©Ÿï¼š1 å¼µ */
    @media (max-width: 560px){
      .kpi-carousel.multi{
        --perView: 1;
        grid-template-columns: 46px 1fr 46px;
      }
      .kpi-arrow{ width: 46px; height: 46px; border-radius: 14px; }
    }

    /* Dark mode for KPI carousel */
    body.dark-mode .kpi-arrow{
      background: rgba(30,41,59,.92);
      border-color: rgba(255,255,255,.10);
      color:#e2e8f0;
      box-shadow: 0 16px 28px rgba(0,0,0,.35);
    }
    body.dark-mode .kpi-carousel.multi .metric-item{
      background: #0f172a;
      box-shadow: 0 16px 28px rgba(0,0,0,.35);
    }
    body.dark-mode .kpi-dot{ background: rgba(148,163,184,.22); }
    body.dark-mode .kpi-dot.active{ background: rgba(165,180,252,.85); }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar" id="navbar">
    <div class="navbar-content">
      <div class="navbar-brand"><span>ğŸª</span>ä¾¿åˆ©å•†åº—åˆ†æå„€è¡¨æ¿</div>

      <!-- âœ… æ‰‹æ©Ÿæ¼¢å ¡æŒ‰éˆ• -->
      <button class="nav-toggle" id="navToggle" aria-label="é–‹é—œé¸å–®" aria-expanded="false">â˜°</button>

      <!-- âœ… å¯æŠ˜ç–Šé¸å–® -->
      <div class="nav-links" id="navLinks">
        <a class="nav-link" onclick="scrollToSection('stats')">çµ±è¨ˆæ•¸æ“š</a>
        <a class="nav-link" onclick="scrollToSection('brands')">å“ç‰Œåˆ†æ</a>
        <a class="nav-link" onclick="scrollToSection('metrics')">é—œéµæŒ‡æ¨™</a>
        <a class="nav-link" onclick="scrollToSection('viz')">è¦–è¦ºåŒ–</a>
        <a class="nav-link" onclick="window.open('index.html','_blank','width=550,height=950')">æ‰‹æ©Ÿç‰ˆ</a>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ›æ·±è‰²æ¨¡å¼">ğŸŒ™</button>
      </div>
    </div>
  </nav>

  <!-- Scroll to top -->
  <button class="scroll-to-top" id="scrollTopBtn" onclick="scrollToTop()" aria-label="è¿”å›é ‚éƒ¨">
    <i class="fa fa-chevron-up"></i>
  </button>

  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <h1>å°ç£ä¾¿åˆ©å•†åº—ç”Ÿæ…‹ç³»å¤§æ•¸æ“šåˆ†æ</h1>
        <p class="subtitle">åŸºæ–¼ MongoDB Atlas Charts çš„è¦–è¦ºåŒ–è³‡æ–™æ¢ç´¢</p>
        <span class="badge">å–µå–µè³‡æ–™æ´¾
          <img src="cat1.png" width="25" height="25" style="vertical-align:middle; margin:0 6px; border-radius:20%;">
        </span>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Section: Stats -->
    <section class="section" id="stats">
      <div class="section-header">
        <h2>ğŸ“Œ å¿«é€Ÿæ¦‚è¦½</h2>
        <p>æœ¬å€å‘ˆç¾è³‡æ–™è¦æ¨¡èˆ‡åˆ†æè¦†è“‹ç¯„åœï¼Œä½œç‚ºæ•´é«”å„€è¡¨æ¿çš„èƒŒæ™¯èªªæ˜ã€‚</p>
      </div>

      <div class="stats-container">
        <div class="stat-card" onclick="animateCard(this)">
          <div class="stat-icon">ğŸª</div>
          <div class="stat-value">13,632</div>
          <div class="stat-label">ä¾¿åˆ©å•†åº—ç¸½æ•¸</div>
        </div>
        <div class="stat-card" onclick="animateCard(this)">
          <div class="stat-icon">ğŸ“</div>
          <div class="stat-value">368</div>
          <div class="stat-label">æ¶µè“‹é„‰é®å¸‚å€</div>
        </div>
        <div class="stat-card" onclick="animateCard(this)">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-value">50+</div>
          <div class="stat-label">åˆ†æç¶­åº¦</div>
        </div>
        <div class="stat-card" onclick="animateCard(this)">
          <div class="stat-icon">ğŸ”„</div>
          <div class="stat-value">å³æ™‚</div>
          <div class="stat-label">Charts å‘ˆç¾</div>
        </div>
      </div>
    </section>

    <!-- Section: Brands -->
    <section class="section" id="brands">
      <div class="section-header">
        <h2>ğŸª äº”å¤§å“ç‰Œç¯„åœ</h2>
        <p>é»é¸å“ç‰Œå¡ç‰‡å¯å±•é–‹ã€Œå…¨å°åº—æ•¸ã€æ‘˜è¦ã€‚</p>
      </div>

      <div class="card">
        <div class="brands-grid">
          <div class="brand-card seven" onclick="toggleBrandInfo(this)">
            <span class="brand-count ">7,013 é–“</span>
            <div class="brand-logo">
              <img src="https://www.7-11.com.tw/Company/esg/images/fbsharelogo.jpg" alt="7-ELEVEN">
            </div>
            <div class="brand-name">7-ELEVEN</div>
            <div class="brand-store-info">
              <div class="store-number">7,013</div>
              <div class="store-label">å…¨å°ç¸½åº—æ•¸</div>
            </div>
          </div>

          <div class="brand-card family" onclick="toggleBrandInfo(this)">
            <span class="brand-count">3,559 é–“</span>
            <div class="brand-logo">
              <img src="https://play-lh.googleusercontent.com/e3AKbefh3znufeBBSF1anaUZwV7oSkTjNCn67ZdSD18DwE95y7lZY9uHDloXH8fcmg" alt="FamilyMart">
            </div>
            <div class="brand-name">FamilyMart</div>
            <div class="brand-store-info">
              <div class="store-number">3,559</div>
              <div class="store-label">å…¨å°ç¸½åº—æ•¸</div>
            </div>
          </div>

          <div class="brand-card hilife" onclick="toggleBrandInfo(this)">
            <span class="brand-count">1,483 é–“</span>
            <div class="brand-logo">
              <img src="https://picdn.gomaji.com/uploads/stores/893/49893/255331/%E8%90%8A%E7%88%BE%E5%AF%8C%E6%96%B0%E7%89%88LOGO-RGB-(1).png" alt="Hi-Life">
            </div>
            <div class="brand-name">Hi-Life</div>
            <div class="brand-store-info">
              <div class="store-number">1,483</div>
              <div class="store-label">å…¨å°ç¸½åº—æ•¸</div>
            </div>
          </div>

          <div class="brand-card ok" onclick="toggleBrandInfo(this)">
            <span class="brand-count">286 é–“</span>
            <div class="brand-logo">
              <img src="https://play-lh.googleusercontent.com/wPmx6o5n7b2rdlmcn6PVhKkO0PkC7qSwIT2fJyyMrfg5VvCVzES-t84gmYOgP-4Avqo=w600-h300-pc0xffffff-pd" alt="OK Mart">
            </div>
            <div class="brand-name">OK Mart</div>
            <div class="brand-store-info">
              <div class="store-number">286</div>
              <div class="store-label">å…¨å°ç¸½åº—æ•¸</div>
            </div>
          </div>

          <div class="brand-card pxmart" onclick="toggleBrandInfo(this)">
            <span class="brand-count">1,291 é–“</span>
            <div class="brand-logo">
              <img src="https://curation.culture.tw/api/pic?id=User022cdfcd8-a336-483b-83dc-7a89288f6863&w=300" alt="PX Mart">
            </div>
            <div class="brand-name">PX Mart</div>
            <div class="brand-store-info">
              <div class="store-number">1,291</div>
              <div class="store-label">å…¨å°ç¸½åº—æ•¸</div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- âœ… Section: Metrics (Multi-Card Carousel) -->
    <section class="section" id="metrics">
      <div class="section-header">
        <h2>ğŸ’¡ é—œéµæŒ‡æ¨™èªªæ˜</h2>
        <p>ä¸€æ’é¡¯ç¤ºå¤šå¼µå¡ç‰‡ï¼Œå¯å·¦å³åˆ‡æ›æŸ¥çœ‹å…§å®¹ï¼ˆæ‰‹æ©Ÿæ”¯æ´æ‹–æ›³ï¼‰ã€‚</p>
      </div>

      <div class="card">
        <div class="kpi-carousel multi" id="kpiCarousel" aria-label="é—œéµæŒ‡æ¨™è¼ªæ’­ï¼ˆå¤šå¡ï¼‰">
          <button class="kpi-arrow prev" type="button" aria-label="ä¸Šä¸€é ">â€¹</button>

          <div class="kpi-viewport">
            <div class="kpi-track">
              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ“ˆ å€åŸŸå¯†åº¦åˆ†æ</div>
                  <div class="metric-description">
                    ä»¥ã€Œæ¯è¬äººä¾¿åˆ©å•†åº—æ•¸ã€è¡¡é‡æœå‹™å¯åŠæ€§èˆ‡éƒ½å¸‚åŒ–ç¨‹åº¦ï¼Œé©åˆè·¨ç¸£å¸‚æ¯”è¼ƒã€‚
                  </div>
                </div>
              </div>

              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ¢ å“ç‰Œå¸‚å ç‡</div>
                  <div class="metric-description">
                    çµ±è¨ˆäº”å¤§å“ç‰Œé–€å¸‚æ•¸èˆ‡å æ¯”ï¼Œå‘ˆç¾å°ç£ä¾¿åˆ©å•†åº—å¸‚å ´ç«¶çˆ­çµæ§‹ã€‚
                  </div>
                </div>
              </div>

              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ—ºï¸ åœ°ç†åˆ†å¸ƒç†±å€</div>
                  <div class="metric-description">
                    ä»¥ç¸£å¸‚/è¡Œæ”¿å€å±¤ç´šçš„ç†±é»åˆ†æï¼Œæ‰¾å‡ºé£½å’Œå€èˆ‡å¯èƒ½ç¼ºå£ã€‚
                  </div>
                </div>
              </div>

              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ‘¥ äººå£èˆ‡é–€å¸‚é—œä¿‚</div>
                  <div class="metric-description">
                    çµåˆäººå£è³‡æ–™ï¼Œè§€å¯Ÿã€Œäººå£ vs é–€å¸‚æ•¸ã€æ˜¯å¦å‘ˆç¾æ¯”ä¾‹æˆ–é›†ä¸­ç¾è±¡ã€‚
                  </div>
                </div>
              </div>

              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ™ï¸ åŸé„‰å·®ç•°èˆ‡é›†ä¸­åº¦</div>
                  <div class="metric-description">
                    æ¯”è¼ƒéƒ½æœƒå€èˆ‡ééƒ½æœƒå€çš„é–€å¸‚åˆ†å¸ƒå·®ç•°ï¼Œè§€å¯Ÿæ˜¯å¦å‘ˆç¾ã€Œæ ¸å¿ƒåŸå¸‚é«˜åº¦é›†ä¸­ã€æˆ–ã€Œå‡è¡¡æ“´æ•£ã€çš„å‹æ…‹ï¼Œ
                    ä»¥åˆ¤æ–·ä¾¿åˆ©å•†åº—å±•åº—ç­–ç•¥èˆ‡æœå‹™è¦†è“‹æ˜¯å¦å‡è¡¡ã€‚
                  </div>
                </div>
              </div>

              <div class="kpi-card">
                <div class="metric-item">
                  <div class="metric-name">ğŸ“Œ è¡Œæ”¿å€é£½å’Œåº¦æ’è¡Œ</div>
                  <div class="metric-description">
                    ä»¥è¡Œæ”¿å€å±¤ç´šè¨ˆç®—é–€å¸‚æ•¸ï¼ˆæˆ–æ¯è¬äººé–€å¸‚æ•¸ï¼‰ï¼Œæ‰¾å‡ºã€Œé£½å’Œå€ï¼ç«¶çˆ­æ¿€çƒˆå€ã€èˆ‡ã€Œå¯èƒ½ç¼ºå£å€ã€ï¼Œ
                    å¯å»¶ä¼¸ç”¨æ–¼é¸å€åˆ†æã€å¸‚å ´ç«¶çˆ­ç ”ç©¶æˆ–å±•åº—æ±ºç­–åƒè€ƒã€‚
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button class="kpi-arrow next" type="button" aria-label="ä¸‹ä¸€é ">â€º</button>
          <div class="kpi-dots" id="kpiDots" aria-label="è¼ªæ’­æŒ‡ç¤ºé»"></div>
        </div>
      </div>
    </section>

    <!-- Section: Visualization (Charts) -->
    <section class="section" id="viz">
      <div class="section-header">
        <h2>ğŸ“Š Atlas Charts è¦–è¦ºåŒ–å„€è¡¨æ¿</h2>
        <p>æ­¤å€ç‚º MongoDB Atlas Charts åµŒå…¥çµæœï¼ˆç„¡ç¯©é¸åŠŸèƒ½ç‰ˆæœ¬ï¼‰ï¼Œç”¨æ–¼å±•ç¤ºèšåˆåˆ†æèˆ‡åœ–è¡¨ã€‚</p>
      </div>

      <div class="card dashboard-shell">
        <div id="dashboardMount"></div>

        <div class="loading-overlay" id="loadingOverlay">
          <div class="spinner"></div>
          <span>è¼‰å…¥å„€è¡¨æ¿ä¸­...</span>
        </div>
      </div>
    </section>
  </main>

  <!-- âœ… Chatbot Widget -->
  <div class="bot-launcher" id="botLauncher" aria-label="é–‹å•Ÿå®¢æœ">
    ğŸ’¬
    <span class="bot-badge" id="botBadge">1</span>
  </div>

  <div class="bot-panel" id="botPanel" role="dialog" aria-label="å®¢æœæ©Ÿå™¨äºº">
    <div class="bot-header">
      <div class="bot-title">
        <div class="bot-avatar">
          <img src="cat1.png" alt="cat">
        </div>
        <div>
          <div class="bot-name">å–µå–µå°å¹«æ‰‹</div>
          <div class="bot-sub">å›ç­”å„€è¡¨æ¿èˆ‡è³‡æ–™å•é¡Œ</div>
        </div>
      </div>
      <button class="bot-close" id="botClose" aria-label="é—œé–‰">âœ•</button>
    </div>

    <div class="bot-quick" id="botQuick">
      <button class="bot-chip">é€™å€‹ç¶²ç«™åœ¨åšä»€éº¼ï¼Ÿ</button>
      <button class="bot-chip">äº”å¤§è¶…å•†å„æœ‰å¹¾é–“ï¼Ÿ</button>
      <button class="bot-chip">è³‡æ–™ä¾†æºæ˜¯ä»€éº¼ï¼Ÿ</button>
      <button class="bot-chip">status=1 æ˜¯ä»€éº¼æ„æ€ï¼Ÿ</button>
    </div>

    <div class="bot-messages" id="botMessages"></div>

    <form class="bot-input" id="botForm">
      <input id="botText" type="text" placeholder="è¼¸å…¥ä½ çš„å•é¡Œâ€¦ï¼ˆä¾‹å¦‚ï¼šå“ç‰Œå¸‚å æ€éº¼ç®—ï¼Ÿï¼‰" autocomplete="off" />
      <button type="submit">é€å‡º</button>
    </form>
  </div>

  <footer>
    <div>
      <p>è³‡æ–™ä¾†æºï¼šå°ç£é–‹æ”¾è³‡æ–™å¹³å°ï½œè¦–è¦ºåŒ–ï¼šMongoDB Atlas Chartsï½œæœ¬ç¶²ç«™ä¾›æœŸæœ«å°ˆé¡Œå±•ç¤ºä½¿ç”¨</p>
      <div class="tech-stack">
        <span class="tech-item">MongoDB Atlas</span>
        <span class="tech-item">Atlas Charts</span>
        <span class="tech-item">Claude</span>
        <span class="tech-item">JavaScript</span>
        <span class="tech-item">RWD</span>
      </div>
      <p class="team">&copy; 2025/12/25 è£½ä½œè€…ï¼šè³‡ç®¡äºŒä¹™ å–µå–µè³‡æ–™æ´¾
        <img src="cat1.png" width="25" height="25" style="vertical-align:middle; margin:0 6px">
      </p>
    </div>
  </footer>

  <script>
    // --- UI helpers ---
    function scrollToSection(id){
      const el = document.getElementById(id);
      if(!el) return;
      const y = el.getBoundingClientRect().top + window.pageYOffset - 80;
      window.scrollTo({ top: y, behavior: "smooth" });
      closeNavMenu(); // âœ… æ‰‹æ©Ÿé»é¸å¾Œè‡ªå‹•æ”¶åˆ
    }

    function scrollToTop(){ window.scrollTo({ top: 0, behavior: "smooth" }); }

    function toggleBrandInfo(element){
      document.querySelectorAll('.brand-card').forEach(card => {
        if(card !== element) card.classList.remove('active');
      });
      element.classList.toggle('active');
    }

    function toggleTheme(){
      document.body.classList.toggle('dark-mode');
      const btn = document.querySelector('.theme-toggle');
      const isDark = document.body.classList.contains('dark-mode');
      btn.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    function animateCard(el){
      el.style.transform = "translateY(-7px) scale(1.02)";
      setTimeout(()=>{ el.style.transform = ""; }, 180);
    }

    // âœ… æŠ˜ç–Š Navbar logic
    const navToggle = document.getElementById("navToggle");
    const navLinks = document.getElementById("navLinks");

    function toggleNavMenu(){
      navLinks.classList.toggle("show");
      const opened = navLinks.classList.contains("show");
      navToggle.setAttribute("aria-expanded", opened ? "true" : "false");
      navToggle.textContent = opened ? "âœ•" : "â˜°";
    }
    function closeNavMenu(){
      navLinks.classList.remove("show");
      navToggle.setAttribute("aria-expanded", "false");
      navToggle.textContent = "â˜°";
    }

    navToggle.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleNavMenu();
    });

    // é»å¤–é¢æ”¶èµ·ï¼ˆæ‰‹æ©Ÿé«”é©—ï¼‰
    document.addEventListener("click", (e) => {
      if(!navLinks.classList.contains("show")) return;
      const clickedInside = navLinks.contains(e.target) || navToggle.contains(e.target);
      if(!clickedInside) closeNavMenu();
    });

    // æ²å‹•å°±æ”¶èµ·ï¼ˆé¿å…é®ä½å…§å®¹ï¼‰
    window.addEventListener("scroll", () => {
      if(navLinks.classList.contains("show")) closeNavMenu();
    }, { passive: true });

    // Navbar shadow + scrollTop button + cc å‹•æ…‹
    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      const btn = document.getElementById('scrollTopBtn');

      if(window.scrollY > 10) navbar.classList.add('scrolled');
      else navbar.classList.remove('scrolled');

      if(window.scrollY > 350) btn.classList.add('visible');
      else btn.classList.remove('visible');

      if (window.scrollY > 40) navbar.classList.add('cc');
      else navbar.classList.remove('cc');
    });

    // Load saved theme
    if(localStorage.getItem('theme') === 'dark'){
      document.body.classList.add('dark-mode');
      document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
    }

    // --- MongoDB Charts embed ---
    const baseUrl = "https://charts.mongodb.com/charts-project-0-hrywltb";
    const dashboardId = "69424a29-3617-4b8e-8c65-12ff665a20f7";

    const sdk = new ChartsEmbedSDK({ baseUrl });

    const dashboard = sdk.createDashboard({
      dashboardId,
      height: "100%",
      width: "100%",
      theme: "light",
      autoRefresh: true
    });

    const overlay = document.getElementById("loadingOverlay");
    dashboard.render(document.getElementById("dashboardMount"))
      .then(() => {
        if(overlay) overlay.style.display = "none";
      })
      .catch(err => {
        console.error("Error rendering dashboard:", err);
        if(overlay){
          overlay.innerHTML = '<span style="color:#e53e3e; font-weight:800;">âš ï¸ å„€è¡¨æ¿è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Dashboard ID</span>';
        }
      });

    /* =========================================================
       âœ… KPI Carousel logicï¼ˆå¤šå¡ç‰ˆæœ¬ï¼‰
       - æ¯é ç§»å‹• perView å¼µ
       - dots ä»£è¡¨é æ•¸
       - æ‰‹æ©Ÿæ‹–æ›³ / å·¦å³éµæ”¯æ´
       ========================================================= */
    (function(){
      const root = document.getElementById("kpiCarousel");
      if(!root) return;

      const track = root.querySelector(".kpi-track");
      const cards = Array.from(root.querySelectorAll(".kpi-card"));
      const prev = root.querySelector(".kpi-arrow.prev");
      const next = root.querySelector(".kpi-arrow.next");
      const dotsWrap = document.getElementById("kpiDots");

      let page = 0;
      let perView = 5;
      let totalPages = 1;
      let cardW = 0;
      let gap = 14;

      function readLayout(){
        const pv = getComputedStyle(root).getPropertyValue("--perView").trim();
        perView = Math.max(1, parseInt(pv || "5", 10));

        const tg = getComputedStyle(track).gap || "14px";
        gap = parseFloat(tg);

        cardW = cards[0]?.getBoundingClientRect().width || 0;

        totalPages = Math.max(1, Math.ceil(cards.length / perView));
        page = Math.min(page, totalPages - 1);

        buildDots();
        render();
      }

      function buildDots(){
        dotsWrap.innerHTML = "";
        for(let i=0;i<totalPages;i++){
          const b = document.createElement("button");
          b.type = "button";
          b.className = "kpi-dot" + (i===page ? " active" : "");
          b.setAttribute("aria-label", `ç¬¬ ${i+1} é `);
          b.addEventListener("click", ()=> { page = i; render(); });
          dotsWrap.appendChild(b);
        }
      }

      function render(){
        const offsetCards = page * perView;
        const x = -(offsetCards * (cardW + gap));
        track.style.transform = `translateX(${x}px)`;

        prev.disabled = (page === 0);
        next.disabled = (page === totalPages - 1);

        Array.from(dotsWrap.children).forEach((d, i) => {
          d.classList.toggle("active", i === page);
        });
      }

      prev.addEventListener("click", ()=> { page = Math.max(0, page - 1); render(); });
      next.addEventListener("click", ()=> { page = Math.min(totalPages - 1, page + 1); render(); });

      // éµç›¤å·¦å³éµ
      window.addEventListener("keydown", (e) => {
        if(document.activeElement && ["INPUT","TEXTAREA"].includes(document.activeElement.tagName)) return;
        if(e.key === "ArrowLeft") { page = Math.max(0, page - 1); render(); }
        if(e.key === "ArrowRight") { page = Math.min(totalPages - 1, page + 1); render(); }
      });

      // æ‰‹æ©Ÿæ‹–æ›³æ»‘å‹•
      const viewport = root.querySelector(".kpi-viewport");
      let startX = 0;
      let startTranslate = 0;
      let dragging = false;

      function getCurrentTranslate(){
        const m = track.style.transform.match(/translateX\(([-0-9.]+)px\)/);
        return m ? parseFloat(m[1]) : 0;
      }

      viewport.addEventListener("pointerdown", (e) => {
        dragging = true;
        startX = e.clientX;
        startTranslate = getCurrentTranslate();
        viewport.setPointerCapture(e.pointerId);
        track.style.transition = "none";
      });

      viewport.addEventListener("pointermove", (e) => {
        if(!dragging) return;
        const dx = e.clientX - startX;
        track.style.transform = `translateX(${startTranslate + dx}px)`;
      });

      viewport.addEventListener("pointerup", (e) => {
        if(!dragging) return;
        dragging = false;
        track.style.transition = "transform .35s ease";

        const dx = e.clientX - startX;
        if(Math.abs(dx) > 60){
          if(dx < 0) page = Math.min(totalPages - 1, page + 1);
          else page = Math.max(0, page - 1);
        }
        render();
      });

      viewport.addEventListener("pointercancel", ()=> {
        dragging = false;
        track.style.transition = "transform .35s ease";
        render();
      });

      window.addEventListener("resize", () => {
        clearTimeout(window.__kpiResizeTimer);
        window.__kpiResizeTimer = setTimeout(readLayout, 80);
      });

      readLayout();
    })();

    // âœ… Chatbot logic (no backend)
    (function(){
      const launcher = document.getElementById("botLauncher");
      const panel = document.getElementById("botPanel");
      const closeBtn = document.getElementById("botClose");
      const badge = document.getElementById("botBadge");
      const msgBox = document.getElementById("botMessages");
      const form = document.getElementById("botForm");
      const input = document.getElementById("botText");
      const quick = document.getElementById("botQuick");

      const KB = [
        {
          keys: ["åšä»€éº¼", "ä»‹ç´¹", "ç¶²ç«™", "å°ˆé¡Œ"],
          answer:
`é€™å€‹ç¶²ç«™æ˜¯ã€Œå°ç£äº”å¤§ä¾¿åˆ©å•†åº—é–€å¸‚åˆ†æã€çš„å„€è¡¨æ¿å±•ç¤ºã€‚
æµç¨‹ï¼šé–‹æ”¾è³‡æ–™ â†’ Python æ¸…æ´— â†’ MongoDB Atlas â†’ Atlas Charts â†’ åµŒå…¥åˆ°æ­¤ç¶²é ã€‚
ä½ å¯ä»¥åœ¨ä¸‹æ–¹è¦–è¦ºåŒ–å€æŸ¥çœ‹ç¸£å¸‚åˆ†å¸ƒã€å“ç‰Œå¸‚å ã€äººå£/å¯†åº¦é—œä¿‚ç­‰çµæœã€‚`
        },
        {
          keys: ["äº”å¤§", "å¹¾é–“", "åº—æ•¸", "ç¸½åº—æ•¸", "å„æœ‰å¹¾é–“"],
          answer:
`äº”å¤§å“ç‰Œçš„å…¨å°é–€å¸‚æ•¸æ˜¯ä»¥ã€Œstatus=1ï¼ˆç‡Ÿæ¥­ä¸­ï¼‰ã€ç‚ºæ¢ä»¶ï¼Œ
åœ¨ MongoDB ç”¨ Aggregation ä¾ brand åˆ†çµ„è¨ˆç®—å¾—åˆ°ã€‚
ï¼ˆä½ ä¹Ÿå¯ä»¥æŠŠä½ æŸ¥åˆ°çš„æ•¸å­—è²¼é€²å“ç‰Œå¡ç‰‡å€å¡Šï¼Œè®“å‰ç«¯åŒæ­¥é¡¯ç¤ºã€‚ï¼‰`
        },
        {
          keys: ["è³‡æ–™ä¾†æº", "opendata", "é–‹æ”¾è³‡æ–™"],
          answer:
`è³‡æ–™ä¾†æºï¼šæ”¿åºœé–‹æ”¾è³‡æ–™ï¼ˆé–€å¸‚æ¸…å†Šï¼‰ï¼‹ï¼ˆå¯é¸ï¼‰äººå£è³‡æ–™ï¼ˆç”¨æ–¼æ¯è¬äººåº—æ•¸ç­‰æŒ‡æ¨™ï¼‰ã€‚
æˆ‘å€‘å…ˆæ¸…æ´—æ¬„ä½/ç¸£å¸‚æ˜ å°„/statusTextï¼Œå†åŒ¯å…¥ MongoDB Atlas é€²è¡Œåˆ†æã€‚`
        },
        {
          keys: ["status", "status=1", "ç‡Ÿæ¥­ä¸­", "åœæ¥­", "æ’¤éŠ·", "å»¢æ­¢"],
          answer:
`status æ˜¯é–€å¸‚ç‹€æ…‹æ¬„ä½ã€‚
å¸¸è¦‹å°æ‡‰ï¼š
1=æ ¸å‡†è¨­ç«‹ï¼ˆç‡Ÿæ¥­ä¸­ï¼‰ã€2=åœæ¥­ã€3=å»¢æ­¢ã€6=æ’¤éŠ·ã€‚
ç›®å‰çµ±è¨ˆé€šå¸¸æœƒç”¨ status=1 ä»£è¡¨ã€Œç‡Ÿæ¥­ä¸­é–€å¸‚ã€ã€‚`
        },
        {
          keys: ["ç‚ºä»€éº¼", "ä¸ç›´æ¥", "é€£", "mongodb", "å‰ç«¯"],
          answer:
`å‰ç«¯ä¸ç›´æ¥é€£ MongoDB æ˜¯ç‚ºäº†å®‰å…¨èˆ‡æ¶æ§‹æ­£ç¢ºï¼š
1) æœƒæš´éœ²é€£ç·šå­—ä¸²/å¸³å¯†
2) éœ€è¦å¾Œç«¯æ‰èƒ½å®‰å…¨å­˜å–
æˆ‘å€‘æ”¹ç”¨ Atlas Charts åšè¦–è¦ºåŒ–ä¸­ä»‹ï¼Œå‰ç«¯åªè² è²¬åµŒå…¥èˆ‡å±•ç¤ºã€‚`
        }
      ];

      function addMessage(text, who){
        const row = document.createElement("div");
        row.className = "bot-row " + who;
        const bubble = document.createElement("div");
        bubble.className = "bot-bubble";
        bubble.innerHTML = text;
        row.appendChild(bubble);
        msgBox.appendChild(row);
        msgBox.scrollTop = msgBox.scrollHeight;
      }

      function botReply(userText){
        const t = (userText || "").trim();
        if(!t) return;

        const hit = KB.find(item => item.keys.some(k => t.toLowerCase().includes(k.toLowerCase())));
        const reply = hit ? hit.answer :
`å–µï¼æˆ‘çš„åŠŸèƒ½æ˜¯å¹«ä½ è§£é‡‹é€™å€‹å„€è¡¨æ¿çš„åœ–è¡¨èˆ‡æŒ‡æ¨™ï½ä½ å¯ä»¥å•æˆ‘ï¼šè³‡æ–™ä¾†æºã€status æ„ç¾©ã€å“ç‰Œå¸‚å æ€éº¼ç®—ã€ç‚ºä»€éº¼ç”¨ Atlas Charts ç­‰ã€‚`;

        setTimeout(() => addMessage(reply, "bot"), 220);
      }

      function openBot(){
        panel.style.display = "block";
        badge.style.display = "none";
        if(msgBox.childElementCount === 0){
          addMessage(`å–µï¼æˆ‘æ˜¯å–µå–µå°å¹«æ‰‹ <img src="cat1.png" width="20" height="20" style="vertical-align:middle; margin:0 6px; border-radius:20%;"> ä½ æƒ³äº†è§£å“ªä¸€éƒ¨åˆ†ï¼Ÿ`, "bot");
        }
        setTimeout(()=> input.focus(), 0);
      }

      function closeBot(){ panel.style.display = "none"; }

      launcher.addEventListener("click", openBot);
      closeBtn.addEventListener("click", closeBot);

      quick.addEventListener("click", (e) => {
        const btn = e.target.closest(".bot-chip");
        if(!btn) return;
        const q = btn.textContent.trim();
        addMessage(q, "user");
        botReply(q);
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const text = input.value;
        input.value = "";
        addMessage(text, "user");
        botReply(text);
      });
    })();
  </script>
</body>
</html>


